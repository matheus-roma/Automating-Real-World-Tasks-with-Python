__all__=('find_exe','remove_files')
import os, shutil, glob, stat

def _remove_file(func, p, _):
    os.chmod(p, stat.S_IWRITE)
    func(p)

def remove_files(*args):
    for pat in args:
        for p in glob.glob(pat):
            if os.path.isfile(p):
                os.chmod(p,0o777)
                _os.remove(p)
            elif os.path.isdir(p):
                os.chmod(p,0o777)
                shutil.rmtree(p,onerror=_remove_file)

def find_exe(exe, path=None, extra_path=None):
    if not path:
        path = os.environ.get('PATH','')

    if isinstance(path,str):
        path = path.split(os.pathsep)

    if extra_path:
        if isinstance(extra_path,str):
            extra_path = extra_path.split(os.pathsep)
        path = extra_path + path

    path = os.pathsep.join(list(filter(None,path)))

    return shutil.which(exe, path=path or None)
